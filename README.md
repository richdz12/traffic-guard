# TrafficGuard

–£—Ç–∏–ª–∏—Ç–∞ –¥–ª—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ —Å–∫–∞–Ω–µ—Ä–æ–≤ –ø–æ—Ä—Ç–æ–≤ —á–µ—Ä–µ–∑ iptables –∏ ipset —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –∏ –∞–≥—Ä–µ–≥–∞—Ü–∏–∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏.

## –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

- [–û –ø—Ä–æ–µ–∫—Ç–µ](#–æ-–ø—Ä–æ–µ–∫—Ç–µ)
  - [–ó–∞—á–µ–º —ç—Ç–æ –Ω—É–∂–Ω–æ?](#–∑–∞—á–µ–º-—ç—Ç–æ-–Ω—É–∂–Ω–æ)
  - [–°–ø–æ—Å–æ–±—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è](#—Å–ø–æ—Å–æ–±—ã-–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è)
  - [–ü—Ä–∞–≤–æ–≤–æ–π —Å—Ç–∞—Ç—É—Å –∏ –ª–µ–≥–∞–ª—å–Ω–æ—Å—Ç—å](#–ø—Ä–∞–≤–æ–≤–æ–π-—Å—Ç–∞—Ç—É—Å-–∏-–ª–µ–≥–∞–ª—å–Ω–æ—Å—Ç—å)
- [–ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç](#–±—ã—Å—Ç—Ä—ã–π-—Å—Ç–∞—Ä—Ç)
- [–£—Å—Ç–∞–Ω–æ–≤–∫–∞](#—É—Å—Ç–∞–Ω–æ–≤–∫–∞)
  - [–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞](#–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è-—É—Å—Ç–∞–Ω–æ–≤–∫–∞)
  - [–†—É—á–Ω–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞](#—Ä—É—á–Ω–∞—è-—É—Å—Ç–∞–Ω–æ–≤–∫–∞)
- [–í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏](#–≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏)
- [–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ](#–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ)
  - [–ü—É–±–ª–∏—á–Ω—ã–µ —Å–ø–∏—Å–∫–∏](#–ø—É–±–ª–∏—á–Ω—ã–µ-—Å–ø–∏—Å–∫–∏)
  - [–ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è](#–ø—Ä–∏–º–µ—Ä—ã-–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è)
  - [–û–ø—Ü–∏–∏](#–æ–ø—Ü–∏–∏)
- [–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ](#–ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ)
  - [–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è](#–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è)
  - [–§–∞–π–ª—ã –ª–æ–≥–æ–≤](#—Ñ–∞–π–ª—ã-–ª–æ–≥–æ–≤)
  - [–§–æ—Ä–º–∞—Ç –∞–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ CSV](#—Ñ–æ—Ä–º–∞—Ç-–∞–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ-csv)
  - [–õ–∏–º–∏—Ç—ã –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è](#–ª–∏–º–∏—Ç—ã-–ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è)
  - [–ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤](#–ø—Ä–æ—Å–º–æ—Ç—Ä-–ª–æ–≥–æ–≤)
- [–ß—Ç–æ —Å–æ–∑–¥–∞–µ—Ç—Å—è –≤ —Å–∏—Å—Ç–µ–º–µ](#—á—Ç–æ-—Å–æ–∑–¥–∞–µ—Ç—Å—è-–≤-—Å–∏—Å—Ç–µ–º–µ)
- [–õ–∏—Ü–µ–Ω–∑–∏—è](#–ª–∏—Ü–µ–Ω–∑–∏—è)

---

## –û –ø—Ä–æ–µ–∫—Ç–µ

### –ó–∞—á–µ–º —ç—Ç–æ –Ω—É–∂–Ω–æ?

**TrafficGuard** - —ç—Ç–æ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç —Å–µ—Ç–µ–≤–æ–π –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏, –∫–æ—Ç–æ—Ä—ã–π –∑–∞—â–∏—â–∞–µ—Ç –≤–∞—à —Å–µ—Ä–≤–µ—Ä –æ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –ø–æ—Ä—Ç–æ–≤ –∏ –Ω–µ—Å–∞–Ω–∫—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –ø–æ–ø—ã—Ç–æ–∫ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è. 

**–û—Å–Ω–æ–≤–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã, –∫–æ—Ç–æ—Ä—ã–µ —Ä–µ—à–∞–µ—Ç:**

1. **–ú–∞—Å—Å–æ–≤–æ–µ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ—Ä—Ç–æ–≤** - —Ä–∞–∑–ª–∏—á–Ω—ã–µ —Å–∫–∞–Ω–µ—Ä—ã –ø–æ—Å—Ç–æ—è–Ω–Ω–æ –ø—Ä–æ–≤–µ—Ä—è—é—Ç –æ—Ç–∫—Ä—ã—Ç—ã–µ –ø–æ—Ä—Ç—ã –Ω–∞ —Å–µ—Ä–≤–µ—Ä–∞—Ö –≤ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–µ, —Å–æ–∑–¥–∞–≤–∞—è –Ω–µ–Ω—É–∂–Ω—É—é –Ω–∞–≥—Ä—É–∑–∫—É –∏ –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–µ —Ä–∏—Å–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

2. **–ù–∞–≥—Ä—É–∑–∫–∞ –Ω–∞ —Å–µ—Ä–≤–∏—Å—ã** - –∫–∞–∂–¥–∞—è –ø–æ–ø—ã—Ç–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –ø–æ—Ç—Ä–µ–±–ª—è–µ—Ç —Ä–µ—Å—É—Ä—Å—ã —Å–µ—Ä–≤–µ—Ä–∞ (CPU, –ø–∞–º—è—Ç—å, —Å–µ—Ç–µ–≤–æ–π —Ç—Ä–∞—Ñ–∏–∫). –ü—Ä–∏ –º–∞—Å—Å–æ–≤–æ–º —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–∏ —ç—Ç–æ –º–æ–∂–µ—Ç –∑–∞–º–µ–¥–ª–∏—Ç—å —Ä–∞–±–æ—Ç—É –ª–µ–≥–∏—Ç–∏–º–Ω—ã—Ö —Å–µ—Ä–≤–∏—Å–æ–≤

3. **–†–∏—Å–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏** - —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —á–∞—Å—Ç–æ —è–≤–ª—è–µ—Ç—Å—è –ø–µ—Ä–≤—ã–º —ç—Ç–∞–ø–æ–º –∞—Ç–∞–∫–∏. –ó–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫–∏ –∏—â—É—Ç —É—è–∑–≤–∏–º—ã–µ —Å–µ—Ä–≤–∏—Å—ã –∏ –æ—Ç–∫—Ä—ã—Ç—ã–µ –ø–æ—Ä—Ç—ã –¥–ª—è —ç–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏–∏

4. **–ó–∞—Å–æ—Ä–µ–Ω–∏–µ –ª–æ–≥–æ–≤** - –ø–æ–ø—ã—Ç–∫–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –æ—Ç —Å–∫–∞–Ω–µ—Ä–æ–≤ –∑–∞–ø–æ–ª–Ω—è—é—Ç —Å–∏—Å—Ç–µ–º–Ω—ã–µ –ª–æ–≥–∏, –∑–∞—Ç—Ä—É–¥–Ω—è—è –∞–Ω–∞–ª–∏–∑ —Ä–µ–∞–ª—å–Ω—ã—Ö –ø—Ä–æ–±–ª–µ–º

5. **–ù–µ—ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤** - –≤–∞—à–∏ —Å–µ—Ä–≤–∏—Å—ã (–≤–µ–±-—Å–µ—Ä–≤–µ—Ä, SSH, –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö) —Ç—Ä–∞—Ç—è—Ç –≤—Ä–µ–º—è –Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫—É –∑–∞–ø—Ä–æ—Å–æ–≤ –æ—Ç —Å–∫–∞–Ω–µ—Ä–æ–≤ –≤–º–µ—Å—Ç–æ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è —Ä–µ–∞–ª—å–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

**TrafficGuard –±–ª–æ–∫–∏—Ä—É–µ—Ç –≤–µ—Å—å —Ç—Ä–∞—Ñ–∏–∫ —Å –∏–∑–≤–µ—Å—Ç–Ω—ã—Ö IP-–∞–¥—Ä–µ—Å–æ–≤ —Å–∫–∞–Ω–µ—Ä–æ–≤ –Ω–∞ —É—Ä–æ–≤–Ω–µ —Å–µ—Ç–µ–≤–æ–≥–æ —Ñ–∏–ª—å—Ç—Ä–∞ (iptables), –¥–æ —Ç–æ–≥–æ –∫–∞–∫ –ø–∞–∫–µ—Ç—ã –¥–æ—Å—Ç–∏–≥–Ω—É—Ç –≤–∞—à–∏—Ö —Å–µ—Ä–≤–∏—Å–æ–≤.**

### –°–ø–æ—Å–æ–±—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

#### 1. –ë–∞–∑–æ–≤–∞—è –∑–∞—â–∏—Ç–∞ —Å–µ—Ä–≤–µ—Ä–∞

–ó–∞—â–∏—Ç–∏—Ç–µ –≤–∞—à VPS/—Å–µ—Ä–≤–µ—Ä –æ—Ç –º–∞—Å—Å–æ–≤—ã—Ö —Å–∫–∞–Ω–µ—Ä–æ–≤:

```bash
sudo traffic-guard full \
  -u https://raw.githubusercontent.com/shadow-netlab/traffic-guard-lists/refs/heads/main/public/government_networks.list
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –í–µ—Å—å —Ç—Ä–∞—Ñ–∏–∫ —Å IP-–∞–¥—Ä–µ—Å–æ–≤ –∏–∑–≤–µ—Å—Ç–Ω—ã—Ö —Å–∫–∞–Ω–µ—Ä–æ–≤ –±—É–¥–µ—Ç –æ—Ç–±—Ä–æ—à–µ–Ω –Ω–∞ —É—Ä–æ–≤–Ω–µ firewall, –Ω–µ –¥–æ—Å—Ç–∏–≥–∞—è –≤–∞—à–∏—Ö —Å–µ—Ä–≤–∏—Å–æ–≤.

#### 2. –ó–∞—â–∏—Ç–∞ —Å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–æ–º

–í–∫–ª—é—á–∏—Ç–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ, —á—Ç–æ–±—ã –≤–∏–¥–µ—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫:

```bash
sudo traffic-guard full \
  -u https://raw.githubusercontent.com/shadow-netlab/traffic-guard-lists/refs/heads/main/public/government_networks.list \
  --enable-logging
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ –ø–æ–ª—É—á–∞–µ—Ç–µ CSV-—Ñ–∞–π–ª —Å –∞–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω–æ–π —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–æ–π: –∫–∞–∫–∏–µ IP –ø—ã—Ç–∞–ª–∏—Å—å –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è, –∏–∑ –∫–∞–∫–∏—Ö —Å–µ—Ç–µ–π (ASN, NETNAME), —Å–∫–æ–ª—å–∫–æ —Ä–∞–∑.

#### 3. –ö–æ–º–ø–ª–µ–∫—Å–Ω–∞—è –∑–∞—â–∏—Ç–∞

–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å–ø–∏—Å–∫–æ–≤ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –¥–ª—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π –∑–∞—â–∏—Ç—ã:

```bash
sudo traffic-guard full \
  -u https://raw.githubusercontent.com/shadow-netlab/traffic-guard-lists/refs/heads/main/public/antiscanner.list \
  -u https://raw.githubusercontent.com/shadow-netlab/traffic-guard-lists/refs/heads/main/public/government_networks.list \
  --enable-logging
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –ë–ª–æ–∫–∏—Ä—É—é—Ç—Å—è –∫–∞–∫ –ø—É–±–ª–∏—á–Ω—ã–µ —Å–∫–∞–Ω–µ—Ä—ã, —Ç–∞–∫ –∏ —Å–ø–µ—Ü–∏—Ñ–∏—á–µ—Å–∫–∏–µ –ø–æ–¥—Å–µ—Ç–∏ –≥–æ—Å—É–¥–∞—Ä—Å—Ç–≤–µ–Ω–Ω—ã—Ö –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–π, –ø—Ä–æ–≤–æ–¥—è—â–∏—Ö –º–∞—Å—Å–æ–≤–æ–µ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ.

#### 4. –°–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–µ —Å–ø–∏—Å–∫–∏ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏

–°–æ–∑–¥–∞–π—Ç–µ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–π —Å–ø–∏—Å–æ–∫ IP/–ø–æ–¥—Å–µ—Ç–µ–π –¥–ª—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏:

```bash
# –°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª —Å –ø–æ–¥—Å–µ—Ç—è–º–∏ (–ø–æ –æ–¥–Ω–æ–π –Ω–∞ —Å—Ç—Ä–æ–∫—É)
cat > /tmp/my-blocklist.txt <<EOF
192.168.1.0/24
10.0.0.0/8
2001:db8::/32
EOF

# –†–∞–∑–º–µ—Å—Ç–∏—Ç–µ —Ñ–∞–π–ª –Ω–∞ –≤–µ–±-—Å–µ—Ä–≤–µ—Ä–µ –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ file://
sudo traffic-guard full -u file:///tmp/my-blocklist.txt
```

### –ü—Ä–∞–≤–æ–≤–æ–π —Å—Ç–∞—Ç—É—Å –∏ –ª–µ–≥–∞–ª—å–Ω–æ—Å—Ç—å

**‚öñÔ∏è –í–ê–ñ–ù–û–ï –Æ–†–ò–î–ò–ß–ï–°–ö–û–ï –†–ê–ó–™–Ø–°–ù–ï–ù–ò–ï**

#### –ß—Ç–æ —ç—Ç–æ —Ç–∞–∫–æ–µ —é—Ä–∏–¥–∏—á–µ—Å–∫–∏?

**TrafficGuard —è–≤–ª—è–µ—Ç—Å—è –ª–µ–≥–∞–ª—å–Ω—ã–º –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–º —Å–µ—Ç–µ–≤–æ–π –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –∫–ª–∞—Å—Å–∞ "firewall" (–º–µ–∂—Å–µ—Ç–µ–≤–æ–π —ç–∫—Ä–∞–Ω).**

#### –ü—Ä–∞–≤–æ–≤–∞—è –∫–≤–∞–ª–∏—Ñ–∏–∫–∞—Ü–∏—è

1. **–≠—Ç–æ –æ–±—ã—á–Ω—ã–π firewall** - TrafficGuard –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –º–µ—Ö–∞–Ω–∏–∑–º—ã Linux (iptables/ipset), –∫–æ—Ç–æ—Ä—ã–µ —è–≤–ª—è—é—Ç—Å—è —à—Ç–∞—Ç–Ω—ã–º–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º–∏ –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–µ—Ç–µ–≤—ã–º —Ç—Ä–∞—Ñ–∏–∫–æ–º

2. **–ó–∞–∫–æ–Ω–Ω–æ–µ –ø—Ä–∞–≤–æ –Ω–∞ –∑–∞—â–∏—Ç—É** - –≤–ª–∞–¥–µ–ª–µ—Ü —Å–µ—Ä–≤–µ—Ä–∞/–∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã –∏–º–µ–µ—Ç –ø–æ–ª–Ω–æ–µ –∑–∞–∫–æ–Ω–Ω–æ–µ –ø—Ä–∞–≤–æ –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä–æ–≤–∞—Ç—å –≤—Ö–æ–¥—è—â–∏–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è –∏ –±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –Ω–µ–∂–µ–ª–∞—Ç–µ–ª—å–Ω—ã–π —Ç—Ä–∞—Ñ–∏–∫

3. **–ê–Ω–∞–ª–æ–≥ –∞–Ω—Ç–∏–≤–∏—Ä—É—Å–∞** - —Ç–∞–∫ –∂–µ –∫–∞–∫ –∞–Ω—Ç–∏–≤–∏—Ä—É—Å –±–ª–æ–∫–∏—Ä—É–µ—Ç –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã–µ –ø—Ä–æ–≥—Ä–∞–º–º—ã, TrafficGuard –±–ª–æ–∫–∏—Ä—É–µ—Ç –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–π —Å–µ—Ç–µ–≤–æ–π —Ç—Ä–∞—Ñ–∏–∫

#### –ß—Ç–æ –¥–µ–ª–∞–µ—Ç —É—Ç–∏–ª–∏—Ç–∞ —Å —Ç–æ—á–∫–∏ –∑—Ä–µ–Ω–∏—è –∑–∞–∫–æ–Ω–∞?

- ‚úÖ **–ë–ª–æ–∫–∏—Ä—É–µ—Ç –≤—Ö–æ–¥—è—â–∏–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è** –∫ –≤–∞—à–µ–º—É —Å–µ—Ä–≤–µ—Ä—É —Å –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã—Ö IP-–∞–¥—Ä–µ—Å–æ–≤
- ‚úÖ **–ù–µ –æ—Å—É—â–µ—Å—Ç–≤–ª—è–µ—Ç –∞—Ç–∞–∫–∏** –Ω–∞ –¥—Ä—É–≥–∏–µ —Å–∏—Å—Ç–µ–º—ã
- ‚úÖ **–ù–µ –ø–µ—Ä–µ—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç —á—É–∂–æ–π —Ç—Ä–∞—Ñ–∏–∫** 
- ‚úÖ **–ù–µ –Ω–∞—Ä—É—à–∞–µ—Ç —Ä–∞–±–æ—Ç—É –¥—Ä—É–≥–∏—Ö —Å–∏—Å—Ç–µ–º**
- ‚úÖ **–ó–∞—â–∏—â–∞–µ—Ç —Ç–æ–ª—å–∫–æ –≤–∞—à—É –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—É**

–≠—Ç–æ –∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ —Ç–æ–º—É, –∫–∞–∫ –≤—ã –∑–∞–∫—Ä—ã–≤–∞–µ—Ç–µ –¥–≤–µ—Ä—å –≤ —Å–≤–æ–π –¥–æ–º –∏–ª–∏ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç–µ —Å–∏–≥–Ω–∞–ª–∏–∑–∞—Ü–∏—é.

#### –ü—Ä–∞–≤–æ–≤—ã–µ –æ—Å–Ω–æ–≤–∞–Ω–∏—è (–†–æ—Å—Å–∏–π—Å–∫–∞—è –§–µ–¥–µ—Ä–∞—Ü–∏—è)

**–°—Ç–∞—Ç—å—è 16 –§–µ–¥–µ—Ä–∞–ª—å–Ω–æ–≥–æ –∑–∞–∫–æ–Ω–∞ –æ—Ç 27.07.2006 N 149-–§–ó "–û–± –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏":**
> –í–ª–∞–¥–µ–ª–µ—Ü –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã –≤–ø—Ä–∞–≤–µ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –¥–æ—Å—Ç—É–ø–∞ –∫ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏

**–°—Ç–∞—Ç—å—è 209 –ì–ö –†–§ (–ø—Ä–∞–≤–æ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏):**
> –°–æ–±—Å—Ç–≤–µ–Ω–Ω–∏–∫ –≤–ø—Ä–∞–≤–µ –ø–æ —Å–≤–æ–µ–º—É —É—Å–º–æ—Ç—Ä–µ–Ω–∏—é —Å–æ–≤–µ—Ä—à–∞—Ç—å –≤ –æ—Ç–Ω–æ—à–µ–Ω–∏–∏ –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∞—â–µ–≥–æ –µ–º—É –∏–º—É—â–µ—Å—Ç–≤–∞ –ª—é–±—ã–µ –¥–µ–π—Å—Ç–≤–∏—è

**–§–µ–¥–µ—Ä–∞–ª—å–Ω—ã–π –∑–∞–∫–æ–Ω –æ—Ç 27.07.2006 N 152-–§–ó "–û –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö":**
> –û–ø–µ—Ä–∞—Ç–æ—Ä –æ–±—è–∑–∞–Ω –ø—Ä–∏–Ω–∏–º–∞—Ç—å –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –º–µ—Ä—ã –ø–æ –∑–∞—â–∏—Ç–µ –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

#### –ú–æ–∂–µ—Ç –ª–∏ –±—ã—Ç—å –ø—Ä–∏–≤–ª–µ—á–µ–Ω–∏–µ –∫ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏?

**–ù–ï–¢**, –µ—Å–ª–∏ –≤—ã:
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç–µ —É—Ç–∏–ª–∏—Ç—É –¥–ª—è –∑–∞—â–∏—Ç—ã **—Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–π –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã**
- –ë–ª–æ–∫–∏—Ä—É–µ—Ç–µ —Ç–æ–ª—å–∫–æ **–≤—Ö–æ–¥—è—â–∏–π —Ç—Ä–∞—Ñ–∏–∫ –Ω–∞ —Å–≤–æ–π —Å–µ—Ä–≤–µ—Ä**
- –ù–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ –¥–ª—è –∞—Ç–∞–∫ –∏–ª–∏ –Ω–∞—Ä—É—à–µ–Ω–∏—è —Ä–∞–±–æ—Ç—ã –¥—Ä—É–≥–∏—Ö —Å–∏—Å—Ç–µ–º

**TrafficGuard –ù–ï —è–≤–ª—è–µ—Ç—Å—è:**
- ‚ùå –°—Ä–µ–¥—Å—Ç–≤–æ–º –≤–∑–ª–æ–º–∞
- ‚ùå –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–º DDoS-–∞—Ç–∞–∫
- ‚ùå –ü–û –¥–ª—è –Ω–µ–∑–∞–∫–æ–Ω–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞ –∫ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏
- ‚ùå –°—Ä–µ–¥—Å—Ç–≤–æ–º –æ–±—Ö–æ–¥–∞ –∑–∞—â–∏—Ç—ã

**–í—ã –∏–º–µ–µ—Ç–µ –ø—Ä–∞–≤–æ —Ä–µ—à–∞—Ç—å, –∫—Ç–æ –º–æ–∂–µ—Ç –ø–æ–¥–∫–ª—é—á–∞—Ç—å—Å—è –∫ –≤–∞—à–µ–º—É —Å–µ—Ä–≤–µ—Ä—É.**

#### –î–ª—è –≥–æ—Å—É–¥–∞—Ä—Å—Ç–≤–µ–Ω–Ω—ã—Ö –æ—Ä–≥–∞–Ω–æ–≤

–ï—Å–ª–∏ –ø—Ä–µ–¥—Å—Ç–∞–≤–∏—Ç–µ–ª–∏ –ø—Ä–∞–≤–æ–æ—Ö—Ä–∞–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –æ—Ä–≥–∞–Ω–æ–≤ –∏–Ω—Ç–µ—Ä–µ—Å—É—é—Ç—Å—è —ç—Ç–æ–π —É—Ç–∏–ª–∏—Ç–æ–π:

**TrafficGuard - —ç—Ç–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –º–µ–∂—Å–µ—Ç–µ–≤–æ–π —ç–∫—Ä–∞–Ω (firewall), –∫–æ—Ç–æ—Ä—ã–π:**

1. –ò—Å–ø–æ–ª—å–∑—É–µ—Ç —Ç–æ–ª—å–∫–æ –ª–µ–≥–∞–ª—å–Ω—ã–µ —Å–∏—Å—Ç–µ–º–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã Linux (iptables, ipset)
2. –ë–ª–æ–∫–∏—Ä—É–µ—Ç –≤—Ö–æ–¥—è—â–∏–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è –∫ –∑–∞—â–∏—â–∞–µ–º–æ–º—É —Å–µ—Ä–≤–µ—Ä—É
3. –ù–µ –æ—Å—É—â–µ—Å—Ç–≤–ª—è–µ—Ç –Ω–∏–∫–∞–∫–∏—Ö –∞–∫—Ç–∏–≤–Ω—ã—Ö –¥–µ–π—Å—Ç–≤–∏–π –≤ —Å—Ç–æ—Ä–æ–Ω—É –¥—Ä—É–≥–∏—Ö —Å–∏—Å—Ç–µ–º
4. –Ø–≤–ª—è–µ—Ç—Å—è –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–º –∑–∞—â–∏—Ç—ã –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏, –∞–Ω–∞–ª–æ–≥–∏—á–Ω—ã–º –∫–æ–º–º–µ—Ä—á–µ—Å–∫–∏–º —Ä–µ—à–µ–Ω–∏—è–º (Cisco ASA, pfSense, –∏ —Ç.–¥.)
5. –†–µ–∞–ª–∏–∑—É–µ—Ç —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –ø–æ –∑–∞—â–∏—Ç–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ —Å–æ–≥–ª–∞—Å–Ω–æ 152-–§–ó –∏ –¥—Ä—É–≥–∏–º –Ω–æ—Ä–º–∞—Ç–∏–≤–Ω—ã–º –∞–∫—Ç–∞–º

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω–æ–π —É—Ç–∏–ª–∏—Ç—ã —è–≤–ª—è–µ—Ç—Å—è –∑–∞–∫–æ–Ω–Ω—ã–º –æ—Å—É—â–µ—Å—Ç–≤–ª–µ–Ω–∏–µ–º –ø—Ä–∞–≤–∞ –Ω–∞ –∑–∞—â–∏—Ç—É —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–æ–π –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã.**

#### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

- ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –¥–ª—è –∑–∞—â–∏—Ç—ã —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã—Ö —Å–µ—Ä–≤–µ—Ä–æ–≤
- ‚úÖ –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
- ‚úÖ –•—Ä–∞–Ω–∏—Ç–µ –ª–æ–≥–∏ –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º–∏ –∑–∞–∫–æ–Ω–æ–¥–∞—Ç–µ–ª—å—Å—Ç–≤–∞
- ‚ùå –ù–µ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –¥–ª—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –¥–æ—Å—Ç—É–ø–∞ –∫ —á—É–∂–∏–º —Ä–µ—Å—É—Ä—Å–∞–º
- ‚ùå –ù–µ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –≤ —Å–æ—Å—Ç–∞–≤–µ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–ª—è –Ω–µ–∑–∞–∫–æ–Ω–Ω–æ–π –¥–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

---

## –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∑–∞–ø—É—Å–∫ –∑–∞ 30 —Å–µ–∫—É–Ω–¥:

```bash
# 1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞
curl -fsSL https://raw.githubusercontent.com/dotX12/traffic-guard/master/install.sh | sudo bash

# 2. –ó–∞–ø—É—Å–∫ —Å –±–∞–∑–æ–≤–æ–π –∑–∞—â–∏—Ç–æ–π
sudo traffic-guard full \
  -u https://raw.githubusercontent.com/shadow-netlab/traffic-guard-lists/refs/heads/main/public/antiscanner.list

# 3. (–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫ —á–µ—Ä–µ–∑ 10 –º–∏–Ω—É—Ç
tail -f /var/log/iptables-scanners-aggregate.csv
```

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞

–°–∫–∞—á–∞–π—Ç–µ –∏ –∑–∞–ø—É—Å—Ç–∏—Ç–µ —É—Å—Ç–∞–Ω–æ–≤–æ—á–Ω—ã–π —Å–∫—Ä–∏–ø—Ç:

```bash
curl -fsSL https://raw.githubusercontent.com/dotX12/traffic-guard/master/install.sh | sudo bash
```

–∏–ª–∏

```bash
wget -qO- https://raw.githubusercontent.com/dotX12/traffic-guard/master/install.sh | sudo bash
```

–°–∫—Ä–∏–ø—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:
- –û–ø—Ä–µ–¥–µ–ª–∏—Ç –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É —Å–∏—Å—Ç–µ–º—ã (amd64, 386, arm, arm64)
- –°–∫–∞—á–∞–µ—Ç –ø–æ—Å–ª–µ–¥–Ω–∏–π —Ä–µ–ª–∏–∑ –¥–ª—è –≤–∞—à–µ–π —Å–∏—Å—Ç–µ–º—ã
- –£—Å—Ç–∞–Ω–æ–≤–∏—Ç –±–∏–Ω–∞—Ä–Ω–∏–∫ –≤ `/usr/local/bin`
- –í—ã–¥–∞—Å—Ç –ø—Ä–∞–≤–∞ –Ω–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ

### –†—É—á–Ω–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞

1. –°–∫–∞—á–∞–π—Ç–µ –Ω—É–∂–Ω—ã–π –±–∏–Ω–∞—Ä–Ω–∏–∫ –∏–∑ [–ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —Ä–µ–ª–∏–∑–∞](https://github.com/dotX12/traffic-guard/releases/latest):
   - `traffic-guard-linux-amd64` - –¥–ª—è 64-–±–∏—Ç–Ω—ã—Ö —Å–∏—Å—Ç–µ–º
   - `traffic-guard-linux-386` - –¥–ª—è 32-–±–∏—Ç–Ω—ã—Ö —Å–∏—Å—Ç–µ–º
   - `traffic-guard-linux-arm` - –¥–ª—è ARM
   - `traffic-guard-linux-arm64` - –¥–ª—è ARM64

2. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ:
```bash
sudo mv traffic-guard-linux-* /usr/local/bin/traffic-guard
sudo chmod +x /usr/local/bin/traffic-guard
```

## –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- üì• –°–∫–∞—á–∏–≤–∞–Ω–∏–µ —Å–ø–∏—Å–∫–æ–≤ –ø–æ–¥—Å–µ—Ç–µ–π —Å–∫–∞–Ω–µ—Ä–æ–≤ –∏–∑ –≤–Ω–µ—à–Ω–∏—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤
- üõ°Ô∏è –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ iptables/ip6tables –ø—Ä–∞–≤–∏–ª
- üìä –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ ipset –Ω–∞–±–æ—Ä–∞–º–∏ –¥–ª—è IPv4 –∏ IPv6
- üìù –õ–µ–≥–∫–æ–≤–µ—Å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Å –∞–≥—Ä–µ–≥–∞—Ü–∏–µ–π (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
- üîÑ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–∞–≤–∏–ª –¥–ª—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –ø–æ—Å–ª–µ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### ‚ö†Ô∏è –í–∞–∂–Ω–æ

**–û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ** –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –ø–µ—Ä–µ–¥–∞—Ç—å –æ–¥–∏–Ω –∏–ª–∏ –Ω–µ—Å–∫–æ–ª—å–∫–æ URL —Å —Å–ø–∏—Å–∫–∞–º–∏ –ø–æ–¥—Å–µ—Ç–µ–π —á–µ—Ä–µ–∑ –ø–∞—Ä–∞–º–µ—Ç—Ä `-u`:

```bash
sudo traffic-guard full -u https://raw.githubusercontent.com/shadow-netlab/traffic-guard-lists/refs/heads/main/public/government_networks.list
```

–ú–æ–∂–Ω–æ —É–∫–∞–∑–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤:

```bash
sudo traffic-guard full \
  -u https://raw.githubusercontent.com/shadow-netlab/traffic-guard-lists/refs/heads/main/public/government_networks.list \
  -u https://raw.githubusercontent.com/shadow-netlab/traffic-guard-lists/refs/heads/main/public/antiscanner.list \
  --enable-logging
```

### –ü—É–±–ª–∏—á–Ω—ã–µ —Å–ø–∏—Å–∫–∏

–ì–æ—Ç–æ–≤—ã–µ —Å–ø–∏—Å–∫–∏ –ø–æ–¥—Å–µ—Ç–µ–π —Å–∫–∞–Ω–µ—Ä–æ–≤ –¥–æ—Å—Ç—É–ø–Ω—ã –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏: 
**[shadow-netlab/traffic-guard-lists](https://github.com/shadow-netlab/traffic-guard-lists/tree/main)**

–î–æ—Å—Ç—É–ø–Ω—ã–µ —Å–ø–∏—Å–∫–∏:
- `public/antiscanner.list` - —Å–ø–∏—Å–æ–∫ –æ—Ç **[zakachkin/AntiScanner](https://github.com/zakachkin/AntiScanner)**
- `public/government_networks.list` - –ø–æ–¥—Å–µ—Ç–∏ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Å–∫–∞–Ω–µ—Ä–æ–≤ –≥–æ—Å—É–¥–∞—Ä—Å—Ç–≤–µ–Ω–Ω—ã—Ö –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–π

### –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

–ë–∞–∑–æ–≤–∞—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –±–µ–∑ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è:

```bash
sudo traffic-guard full \
  -u https://raw.githubusercontent.com/shadow-netlab/traffic-guard-lists/refs/heads/main/public/government_networks.list \
  -u https://raw.githubusercontent.com/shadow-netlab/traffic-guard-lists/refs/heads/main/public/antiscanner.list
```

–° –≤–∫–ª—é—á–µ–Ω–Ω—ã–º –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ–º:

```bash
sudo traffic-guard full \
  -u https://raw.githubusercontent.com/shadow-netlab/traffic-guard-lists/refs/heads/main/public/government_networks.list \
  -u https://raw.githubusercontent.com/shadow-netlab/traffic-guard-lists/refs/heads/main/public/antiscanner.list \
  --enable-logging
```

### –û–ø—Ü–∏–∏

- **`-u, --urls`** (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ) - URL –¥–ª—è —Å–∫–∞—á–∏–≤–∞–Ω–∏—è –ø–æ–¥—Å–µ—Ç–µ–π. –ú–æ–∂–Ω–æ —É–∫–∞–∑–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ä–∞–∑
- `-l, --enable-logging` - –≤–∫–ª—é—á–∏—Ç—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π
- `--log-level` - —É—Ä–æ–≤–µ–Ω—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è (debug, info, warn, error). –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é: info

## –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

–ü—Ä–∏ –≤–∫–ª—é—á–µ–Ω–∏–∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è (`--enable-logging`) —Å–æ–∑–¥–∞—é—Ç—Å—è:

1. **`/etc/rsyslog.d/10-iptables-scanners.conf`** - –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è rsyslog
2. **`/etc/logrotate.d/iptables-scanners`** - —Ä–æ—Ç–∞—Ü–∏—è –ª–æ–≥–æ–≤ (–∫–∞–∂–¥—ã–π —á–∞—Å, —Ö—Ä–∞–Ω–∏—Ç—Å—è 2 —á–∞—Å–∞)
3. **`/usr/local/bin/antiscan-aggregate-logs.sh`** - —Å–∫—Ä–∏–ø—Ç –∞–≥—Ä–µ–≥–∞—Ü–∏–∏
4. **`/etc/systemd/system/antiscan-aggregate.service`** - systemd service
5. **`/etc/systemd/system/antiscan-aggregate.timer`** - systemd timer (–∫–∞–∂–¥—ã–µ 10 —Å–µ–∫—É–Ω–¥)

### –§–∞–π–ª—ã –ª–æ–≥–æ–≤

- **`/var/log/iptables-scanners-ipv4.log`** - —Å—ã—Ä—ã–µ –ª–æ–≥–∏ IPv4 (–æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è –∫–∞–∂–¥—ã–µ 30 —Å–µ–∫)
- **`/var/log/iptables-scanners-ipv6.log`** - —Å—ã—Ä—ã–µ –ª–æ–≥–∏ IPv6 (–æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è –∫–∞–∂–¥—ã–µ 30 —Å–µ–∫)
- **`/var/log/iptables-scanners-aggregate.csv`** - –∞–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –≤ CSV —Ñ–æ—Ä–º–∞—Ç–µ

### –§–æ—Ä–º–∞—Ç –∞–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ CSV

–§–∞–π–ª `/var/log/iptables-scanners-aggregate.csv` —Å–æ–¥–µ—Ä–∂–∏—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º whois lookup:

```csv
IP_TYPE|IP_ADDRESS|ASN|NETNAME|COUNT|LAST_SEEN
v4|85.142.100.138|AS49505|JSCCYBEROK-NET|237|2026-01-25T17:08:01.123456+03:00
v6|2001:db8::1|AS12345|EXAMPLE-NET|12|2026-01-25T17:08:05.987654+03:00
```

**–ü–æ–ª—è:**
- `IP_TYPE` - —Ç–∏–ø IP (v4/v6)
- `IP_ADDRESS` - IP –∞–¥—Ä–µ—Å —Å–∫–∞–Ω–µ—Ä–∞
- `ASN` - –Ω–æ–º–µ—Ä –∞–≤—Ç–æ–Ω–æ–º–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã (–∏–∑ whois)
- `NETNAME` - –∏–º—è —Å–µ—Ç–∏ (–∏–∑ whois)
- `COUNT` - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ø—ã—Ç–æ–∫ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
- `LAST_SEEN` - –≤—Ä–µ–º—è –ø–æ—Å–ª–µ–¥–Ω–µ–π –ø–æ–ø—ã—Ç–∫–∏

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- Whois lookup —Å –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ–º (–Ω–µ –ø–æ–≤—Ç–æ—Ä—è–µ—Ç—Å—è –¥–ª—è –æ–¥–Ω–æ–≥–æ IP)
- –¢–∞–π–º–∞—É—Ç lookup: 3 —Å–µ–∫—É–Ω–¥—ã
- CSV –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω –ø–æ COUNT (—Å–∞–º—ã–µ –∞–∫—Ç–∏–≤–Ω—ã–µ —Å–≤–µ—Ä—Ö—É)

### –õ–∏–º–∏—Ç—ã –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è

- –ú–∞–∫—Å–∏–º—É–º **10 –∑–∞–ø–∏—Å–µ–π –≤ –º–∏–Ω—É—Ç—É** –Ω–∞ –∫–∞–∂–¥—ã–π IP (—á—Ç–æ–±—ã –Ω–µ –∑–∞—Å–æ—Ä—è—Ç—å –ª–æ–≥–∏)
- –¢–æ–ø-50 –∞–∫—Ç–∏–≤–Ω—ã—Ö IP –≤ –∫–∞–∂–¥–æ–º –∏–Ω—Ç–µ—Ä–≤–∞–ª–µ –∞–≥—Ä–µ–≥–∞—Ü–∏–∏

### –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤

```bash
# –ü–æ—Å–ª–µ–¥–Ω–∏–µ –∞–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
tail -f /var/log/iptables-scanners-aggregate.csv

# –°—Ç–∞—Ç—É—Å systemd timer
systemctl status antiscan-aggregate.timer

# –õ–æ–≥–∏ –∞–≥—Ä–µ–≥–∞—Ç–æ—Ä–∞
journalctl -u antiscan-aggregate.service -f
```

## –ß—Ç–æ —Å–æ–∑–¥–∞–µ—Ç—Å—è –≤ —Å–∏—Å—Ç–µ–º–µ

### iptables

- **–¶–µ–ø–æ—á–∫–∞**: `SCANNERS-BLOCK`
- **–ü—Ä–∞–≤–∏–ª–∞**: 
  - IPv4: `INPUT -j SCANNERS-BLOCK`
  - IPv6: `INPUT -j SCANNERS-BLOCK`
  - `SCANNERS-BLOCK -m set --match-set SCANNERS-BLOCK-V4 src -j DROP` (IPv4)
  - `SCANNERS-BLOCK -m set --match-set SCANNERS-BLOCK-V6 src -j DROP` (IPv6)

–° –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ–º –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø—Ä–∞–≤–∏–ª–∞ —Å rate-limit.

### ipset

- **–ù–∞–±–æ—Ä—ã**:
  - `SCANNERS-BLOCK-V4` - hash:net –¥–ª—è IPv4
  - `SCANNERS-BLOCK-V6` - hash:net –¥–ª—è IPv6
- **–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è**: `/etc/ipset.conf`

### –ê–≤—Ç–æ–∑–∞–≥—Ä—É–∑–∫–∞

–ü—Ä–∞–≤–∏–ª–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è:
- **Debian/Ubuntu**: `/etc/iptables/rules.v4`, `/etc/iptables/rules.v6`
- **RedHat/CentOS**: —á–µ—Ä–µ–∑ `service iptables save`

## –õ–∏—Ü–µ–Ω–∑–∏—è

MIT
